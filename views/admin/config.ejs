<div class="container">
  <div class="row">
    <div class="col-12 mb-4">
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <h4 class="mb-0">
            <i class="fas fa-cog me-2"></i> Configuración de la Aplicación
          </h4>
        </div>
        <div class="card-body">
          <form action="/admin/config" method="POST" enctype="multipart/form-data">
            <!-- Logo -->
            <div class="mb-4">
              <h5 class="border-bottom pb-2">Logo de la Aplicación</h5>
              <div class="row align-items-center">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="logo" class="form-label">Subir nuevo logo</label>
                    <input type="file" class="form-control" id="logo" name="logo" accept="image/*">
                    <small class="text-muted">Tamaño recomendado: 40x40px</small>
                  </div>
                </div>
                <div class="col-md-6">
                  <% if (config.logo && config.logo.url) { %>
                    <div class="text-center">
                      <p class="mb-2">Logo actual:</p>
                      <img src="<%= config.logo.url %>" alt="<%= config.logo.altText %>" 
                           style="max-width: <%= config.logo.width %>px">
                    </div>
                  <% } %>
                </div>
              </div>
            </div>

            <!-- Nombre de la Aplicación -->
            <div class="mb-4">
              <h5 class="border-bottom pb-2">Información General</h5>
              <div class="mb-3">
                <label for="appName" class="form-label">Nombre de la Aplicación</label>
                <input type="text" class="form-control" id="appName" name="appName" 
                       value="<%= config.appName %>" required>
              </div>
            </div>

            <!-- Colores -->
            <div class="mb-4">
              <h5 class="border-bottom pb-2">Colores</h5>
              <div class="row">
                <div class="col-md-4 mb-3">
                  <label for="navbarColor" class="form-label">Color de la Barra de Navegación</label>
                  <div class="input-group">
                    <input type="color" class="form-control form-control-color" 
                           id="navbarColor" name="colors[navbar]" 
                           value="<%= config.colors.navbar %>">
                    <input type="text" class="form-control" 
                           value="<%= config.colors.navbar %>" 
                           data-color-input="navbarColor">
                  </div>
                </div>
                <div class="col-md-4 mb-3">
                  <label for="primaryColor" class="form-label">Color Principal</label>
                  <div class="input-group">
                    <input type="color" class="form-control form-control-color" 
                           id="primaryColor" name="colors[primary]" 
                           value="<%= config.colors.primary %>">
                    <input type="text" class="form-control" 
                           value="<%= config.colors.primary %>" 
                           data-color-input="primaryColor">
                  </div>
                </div>
                <div class="col-md-4 mb-3">
                  <label for="secondaryColor" class="form-label">Color Secundario</label>
                  <div class="input-group">
                    <input type="color" class="form-control form-control-color" 
                           id="secondaryColor" name="colors[secondary]" 
                           value="<%= config.colors.secondary %>">
                    <input type="text" class="form-control" 
                           value="<%= config.colors.secondary %>" 
                           data-color-input="secondaryColor">
                  </div>
                </div>
              </div>
            </div>

            <!-- Estilos -->
            <div class="mb-4">
              <h5 class="border-bottom pb-2">Estilos</h5>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="cardBorderRadius" class="form-label">Radio de Borde de Tarjetas</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="cardBorderRadius" 
                           name="styles[cardBorderRadius]" 
                           value="<%= parseInt(config.styles.cardBorderRadius) %>" min="0" max="50">
                    <span class="input-group-text">px</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="buttonBorderRadius" class="form-label">Radio de Borde de Botones</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="buttonBorderRadius" 
                           name="styles[buttonBorderRadius]" 
                           value="<%= parseInt(config.styles.buttonBorderRadius) %>" min="0" max="50">
                    <span class="input-group-text">px</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Vista Previa -->
            <div class="mb-4">
              <h5 class="border-bottom pb-2">Vista Previa</h5>
              <div class="preview-section p-3 border rounded">
                <button class="btn btn-primary me-2">Botón Principal</button>
                <button class="btn btn-outline-primary me-2">Botón Outline</button>
                <div class="card d-inline-block" style="width: 200px;">
                  <div class="card-body">
                    <h5 class="card-title">Ejemplo de Tarjeta</h5>
                    <p class="card-text">Vista previa de estilos</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Botones de acción -->
            <div class="d-flex justify-content-between">
              <button type="button" class="btn btn-secondary" onclick="resetearConfiguracion()">
                <i class="fas fa-undo me-2"></i> Resetear a Valores por Defecto
              </button>
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-save me-2"></i> Guardar Cambios
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Script para la vista previa en tiempo real -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Manejar cambios en los inputs de color
  document.querySelectorAll('input[type="color"]').forEach(colorInput => {
    const textInput = document.querySelector(`[data-color-input="${colorInput.id}"]`);
    
    colorInput.addEventListener('input', function(e) {
      textInput.value = e.target.value;
      actualizarVistaPrevia();
    });

    textInput.addEventListener('input', function(e) {
      colorInput.value = e.target.value;
      actualizarVistaPrevia();
    });
  });

  // Manejar cambios en los inputs de radio de borde
  document.querySelectorAll('input[type="number"]').forEach(input => {
    input.addEventListener('input', actualizarVistaPrevia);
  });

  function actualizarVistaPrevia() {
    const primaryColor = document.getElementById('primaryColor').value;
    const cardRadius = document.getElementById('cardBorderRadius').value;
    const buttonRadius = document.getElementById('buttonBorderRadius').value;

    document.querySelector('.preview-section .btn-primary').style.backgroundColor = primaryColor;
    document.querySelector('.preview-section .btn-primary').style.borderColor = primaryColor;
    document.querySelector('.preview-section .btn-outline-primary').style.borderColor = primaryColor;
    document.querySelector('.preview-section .btn-outline-primary').style.color = primaryColor;

    document.querySelectorAll('.preview-section .btn').forEach(btn => {
      btn.style.borderRadius = `${buttonRadius}px`;
    });

    document.querySelector('.preview-section .card').style.borderRadius = `${cardRadius}px`;
  }

  // Función para resetear la configuración
  window.resetearConfiguracion = function() {
    if (confirm('¿Estás seguro de que deseas resetear toda la configuración a sus valores por defecto?')) {
      // Aquí puedes agregar la lógica para resetear
      location.href = '/admin/config/reset';
    }
  };
});
</script> 