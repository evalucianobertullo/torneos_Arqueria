<div class="container">
  <div class="row">
    <div class="col-12 mb-4">
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <h4 class="mb-0">
            <i class="fas fa-cog me-2"></i> Configuración de la Aplicación
          </h4>
        </div>
        <div class="card-body">
          <form action="/admin/config" method="POST" enctype="multipart/form-data">
            <!-- Logo -->
            <div class="mb-4">
              <h5 class="border-bottom pb-2">Logo de la Aplicación</h5>
              <div class="row align-items-center">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="logo" class="form-label">Subir nuevo logo</label>
                    <input type="file" class="form-control" id="logo" name="logo" accept="image/*">
                    <small class="text-muted">Tamaño recomendado: 40x40px</small>
                  </div>
                </div>
                <div class="col-md-6">
                  <% if (config.logo && config.logo.url) { %>
                    <div class="text-center">
                      <p class="mb-2">Logo actual:</p>
                      <img src="<%= config.logo.url %>" alt="<%= config.logo.altText %>" 
                           style="max-width: <%= config.logo.width %>px">
                    </div>
                  <% } %>
                </div>
              </div>
            </div>

            <!-- Nombre de la Aplicación -->
            <div class="mb-4">
              <h5 class="border-bottom pb-2">Información General</h5>
              <div class="mb-3">
                <label for="appName" class="form-label">Nombre de la Aplicación</label>
                <input type="text" class="form-control" id="appName" name="appName" 
                       value="<%= config.appName %>" required>
              </div>
            </div>

            <!-- Color Principal -->
            <div class="mb-4">
              <h5 class="border-bottom pb-2">Color Principal</h5>
              <div class="mb-3">
                <label for="primaryColor" class="form-label">Color Principal</label>
                <div class="input-group">
                  <input type="color" class="form-control form-control-color" 
                         id="primaryColor" name="colors[primary]" 
                         value="<%= config.colors.primary %>">
                  <input type="text" class="form-control" 
                         value="<%= config.colors.primary %>" 
                         data-color-input="primaryColor">
                </div>
                <small class="text-muted">Este color se aplicará a los botones, encabezados y elementos principales de la aplicación.</small>
              </div>
            </div>

            <!-- Vista Previa -->
            <div class="mb-4">
              <h5 class="border-bottom pb-2">Vista Previa</h5>
              <div class="preview-section p-3 border rounded">
                <button class="btn btn-primary me-2">Botón Principal</button>
                <button class="btn btn-outline-primary me-2">Botón Outline</button>
                <div class="card d-inline-block" style="width: 200px;">
                  <div class="card-body">
                    <h5 class="card-title">Ejemplo de Tarjeta</h5>
                    <p class="card-text">Vista previa de estilos</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Botones de acción -->
            <div class="d-flex justify-content-between">
              <button type="button" class="btn btn-secondary" onclick="resetearConfiguracion()">
                <i class="fas fa-undo me-2"></i> Resetear a Valores por Defecto
              </button>
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-save me-2"></i> Guardar Cambios
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Manejar cambios en el input de color
  const colorInput = document.getElementById('primaryColor');
  const textInput = document.querySelector('[data-color-input="primaryColor"]');
  
  colorInput.addEventListener('input', function(e) {
    textInput.value = e.target.value;
    actualizarVistaPrevia();
  });

  textInput.addEventListener('input', function(e) {
    colorInput.value = e.target.value;
    actualizarVistaPrevia();
  });

  function actualizarVistaPrevia() {
    const primaryColor = document.getElementById('primaryColor').value;

    document.querySelector('.preview-section .btn-primary').style.backgroundColor = primaryColor;
    document.querySelector('.preview-section .btn-primary').style.borderColor = primaryColor;
    document.querySelector('.preview-section .btn-outline-primary').style.borderColor = primaryColor;
    document.querySelector('.preview-section .btn-outline-primary').style.color = primaryColor;
  }

  // Función para resetear la configuración
  window.resetearConfiguracion = function() {
    if (confirm('¿Estás seguro de que deseas resetear toda la configuración a sus valores por defecto?')) {
      location.href = '/admin/config/reset';
    }
  };
});</script> 